function SearchBarcode(t,e){if(13==e.keyCode){var O=t.value;O=ReplaceAll(O,"||","|");list_getat(O,1,"|");var _=list_getat(O,2,"|"),r=list_getat(O,3,"|"),a="SELECT TOP 1 STORE DELIVER_DEPT_ID,STORE_LOCATION LOCATION_ID,STOCK_ID,PBS_RELATION_ID AS WRK_ROW_ID,UNIT2 FROM "+dsn2+".STOCKS_ROW WHERE  LOT_NO='"+_+"' ORDER BY PROCESS_DATE DESC,UPD_ID DESC",D=wrk_query(a);if(D.recordcount>0){t.setAttribute("style",ValidStyle);var R=document.getElementById("txtFromDeptLocation");R.setAttribute("style",ValidStyle);var T="SELECT D.DEPARTMENT_HEAD,SL.COMMENT,SL.DEPARTMENT_ID,SL.LOCATION_ID FROM STOCKS_LOCATION as SL ";T+=" INNER JOIN DEPARTMENT AS D ON D.DEPARTMENT_ID=SL.DEPARTMENT_ID  WHERE SL.DEPARTMENT_ID="+D.DELIVER_DEPT_ID[0]+" AND SL.LOCATION_ID="+D.LOCATION_ID[0];var n=wrk_query(T);$("#txtFromDeptLocation").val(n.DEPARTMENT_HEAD[0]+" "+n.COMMENT[0]);var o=searchDepo_3(D.STOCK_ID[0],t,R);if(0==o&&$("#btnKayit").hide(),0==o)return!1;Kaydet(),$("#txtFromDeptId").val(n.DEPARTMENT_ID[0]),$("#txtFromLocId").val(n.LOCATION_ID[0]),$("#FROM_STOCK_ID").val(D.STOCK_ID[0]),$("#FROM_WRK_ROW_ID").val(D.WRK_ROW_ID[0]),$("#FROM_AMOUNT").val(r),$("#TO_AMOUNT").val(r),$("#FROM_LOT_NO").val(_),$("#FROM_UNIT2").val(D.UNIT2),$("#TO_LOT_NO").val(_),$("#exitr").show(500),$("#txtDepoAdi").focus()}else t.setAttribute("style",InValidStyle)}}function searchDepo(t,e){if(13==e.keyCode){var O=$("#FROM_STOCK_ID").val(),_="SELECT D.DEPARTMENT_HEAD,SL.COMMENT,SL.LOCATION_ID,SL.DEPARTMENT_ID FROM "+dsn+".STOCKS_LOCATION AS SL INNER JOIN DEPARTMENT AS D ON D.DEPARTMENT_ID=SL.DEPARTMENT_ID WHERE 1=1 AND COMMENT ='"+t.value+"'",r=wrk_query(_);if(r.recordcount>0){var a="SELECT O.ORDER_ID,ORDER_NUMBER,ORDER_HEAD,ORR.WRK_ROW_ID,ORR.STOCK_ID,ORR.UNIT2 FROM "+dsn3+".ORDERS AS O";a+=" INNER JOIN "+dsn3+".ORDER_ROW AS ORR ON ORR.ORDER_ID=O.ORDER_ID ",a+=" WHERE O.ORDER_STAGE="+AktifSiparisSureci+" AND O.DELIVER_DEPT_ID="+r.DEPARTMENT_ID[0]+" AND O.LOCATION_ID="+r.LOCATION_ID[0]+"  AND ORR.STOCK_ID="+O;var D=wrk_query(a);return D.recordcount>0||15==r.DEPARTMENT_ID[0]?(t.setAttribute("style",ValidStyle),document.getElementById("txtToDeptLocation").setAttribute("style",ValidStyle),$("#txtToDeptId").val(r.DEPARTMENT_ID[0]),$("#txtToLocId").val(r.LOCATION_ID[0]),$("#txtToDeptLocation").val(r.DEPARTMENT_HEAD[0]+"-"+r.COMMENT[0]),$("#TO_STOCK_ID").val(O),D.recordcount>0?$("#TO_WRK_ROW_ID").val(D.WRK_ROW_ID[0]):$("#TO_WRK_ROW_ID").val(""),$("#btnKayit").show(),!0):(t.setAttribute("style",InValidStyle),document.getElementById("txtToDeptLocation").setAttribute("style",InValidStyle),!1)}return t.setAttribute("style",InValidStyle),!1}}function searchDepo_2(t,e){var O=$("#FROM_STOCK_ID").val(),_="SELECT D.DEPARTMENT_HEAD,SL.COMMENT,SL.LOCATION_ID,SL.DEPARTMENT_ID FROM "+dsn+".STOCKS_LOCATION AS SL INNER JOIN DEPARTMENT AS D ON D.DEPARTMENT_ID=SL.DEPARTMENT_ID WHERE 1=1 AND COMMENT ='"+t.value+"'",r=wrk_query(_);if(r.recordcount>0){var a="SELECT O.ORDER_ID,ORDER_NUMBER,ORDER_HEAD,ORR.WRK_ROW_ID,ORR.STOCK_ID,ORR.UNIT2 FROM "+dsn3+".ORDERS AS O";a+=" INNER JOIN "+dsn3+".ORDER_ROW AS ORR ON ORR.ORDER_ID=O.ORDER_ID ",a+=" WHERE O.ORDER_STAGE="+AktifSiparisSureci+" AND O.DELIVER_DEPT_ID="+r.DEPARTMENT_ID[0]+" AND O.LOCATION_ID="+r.LOCATION_ID[0]+"  AND ORR.STOCK_ID="+O;var D=wrk_query(a);D.recordcount>0||15==r.DEPARTMENT_ID[0]?(t.setAttribute("style",ValidStyle),document.getElementById("txtToDeptLocation").setAttribute("style",ValidStyle),$("#txtToDeptId").val(r.DEPARTMENT_ID[0]),$("#txtToLocId").val(r.LOCATION_ID[0]),$("#txtToDeptLocation").val(r.DEPARTMENT_HEAD[0]+"-"+r.COMMENT[0]),$("#TO_STOCK_ID").val(O),D.recordcount>0?$("#TO_WRK_ROW_ID").val(D.WRK_ROW_ID[0]):$("#TO_WRK_ROW_ID").val(""),$("#btnKayit").show()):(t.setAttribute("style",InValidStyle),document.getElementById("txtToDeptLocation").setAttribute("style",InValidStyle))}else t.setAttribute("style",InValidStyle)}function searchDepo_3(t,e,O){var _=document.getElementById("txtDepoAdi").value,r="SELECT D.DEPARTMENT_HEAD,SL.COMMENT,SL.LOCATION_ID,SL.DEPARTMENT_ID FROM "+dsn+".STOCKS_LOCATION AS SL INNER JOIN DEPARTMENT AS D ON D.DEPARTMENT_ID=SL.DEPARTMENT_ID WHERE 1=1 AND COMMENT ='"+_+"'",a=wrk_query(r);if(a.recordcount>0){var D="SELECT O.ORDER_ID,ORDER_NUMBER,ORDER_HEAD,ORR.WRK_ROW_ID,ORR.STOCK_ID,ORR.UNIT2 FROM "+dsn3+".ORDERS AS O";D+=" INNER JOIN "+dsn3+".ORDER_ROW AS ORR ON ORR.ORDER_ID=O.ORDER_ID ",D+=" WHERE O.ORDER_STAGE="+AktifSiparisSureci+" AND O.DELIVER_DEPT_ID="+a.DEPARTMENT_ID[0]+" AND O.LOCATION_ID="+a.LOCATION_ID[0]+"  AND ORR.STOCK_ID="+t;var R=wrk_query(D);R.recordcount>0||15==a.DEPARTMENT_ID[0]?(e.setAttribute("style",ValidStyle),O.setAttribute("style",ValidStyle),document.getElementById("txtToDeptLocation").setAttribute("style",ValidStyle),$("#txtToDeptId").val(a.DEPARTMENT_ID[0]),$("#txtToLocId").val(a.LOCATION_ID[0]),$("#txtToDeptLocation").val(a.DEPARTMENT_HEAD[0]+"-"+a.COMMENT[0]),$("#TO_STOCK_ID").val(t),R.recordcount>0?$("#TO_WRK_ROW_ID").val(R.WRK_ROW_ID[0]):$("#TO_WRK_ROW_ID").val(""),$("#btnKayit").show()):(e.setAttribute("style",InValidStyle),O.setAttribute("style",InValidStyle),document.getElementById("txtToDeptLocation").setAttribute("style",InValidStyle))}else e.setAttribute("style",InValidStyle),e.setAttribute("style",InValidStyle)}function Kaydet(){var t=$("#txtFromDeptId").val(),e=$("#txtFromLocId").val(),O=$("#FROM_WRK_ROW_ID").val(),_=$("#FROM_STOCK_ID").val(),r=$("#FROM_AMOUNT").val(),a=$("#FROM_LOT_NO").val(),D=$("#FROM_UNIT2").val(),R=$("#txtToDeptId").val(),T=$("#txtToLocId").val(),n=$("#TO_WRK_ROW_ID").val(),o=$("#TO_STOCK_ID").val(),E=$("#TO_AMOUNT").val(),l=$("#TO_LOT_NO").val(),I={FROM_DEPARTMENT_ID:t,FROM_LOCATION_ID:e,FROM_WRK_ROW_ID:O,FROM_STOCK_ID:_,FROM_AMOUNT:r,FROM_LOT_NO:a,TO_DEPARTMENT_ID:R,TO_LOCATION_ID:T,TO_WRK_ROW_ID:n,TO_STOCK_ID:o,TO_AMOUNT:E,TO_LOT_NO:l,FROM_UNIT2:D};console.log(I),SendFormData("/index.cfm?fuseaction=settings.emptypopup_partner_test_page&sayfa=14",I)}function fokuslan(){$("#Barcode").val(""),$("#Barcode").focus(),$("#txtFromDeptLocation").val(""),$("#txtFromDeptId").val(""),$("#txtFromLocId").val(""),document.getElementById("Barcode").removeAttribute("style"),document.getElementById("txtFromDeptLocation").removeAttribute("style"),document.getElementById("txtFromDeptId").removeAttribute("style"),document.getElementById("txtFromLocId").removeAttribute("style"),$("#btnKayit").hide()}function sepeteEkle(t,e,O,_,r,a,D,R,T,n,o,E){console.table(arguments);var l=document.createElement("tr"),I=document.createElement("td");I.innerText=D,l.appendChild(I);I=document.createElement("td");I.innerText=e,l.appendChild(I);I=document.createElement("td");I.innerText=O+" "+_,l.appendChild(I);I=document.createElement("td");I.innerText=R+" "+T,l.appendChild(I);I=document.createElement("td");I.innerHTML=r+" &gt; "+a,l.appendChild(I);I=document.createElement("td");I.innerHTML=o+" &gt; "+E,l.appendChild(I);I=document.createElement("td");var d=document.createElement("button");d.setAttribute("class","btn btn-danger"),d.innerText="Sil",d.setAttribute("onclick","fis_sil("+n+",this)"),I.appendChild(d),l.appendChild(I),document.getElementById("Sepetim").appendChild(l),$("#Barcode").html(""),$("#Barcode").focus()}function fis_sil(t,e){$.ajax({url:"/AddOns/Partner/Servis/MasaServis.cfc?method=deleteSelectedFis&FIS_ID="+t,success:function(t){console.log(t),e.parentElement.parentElement.remove()}})}function wrk_query(str_query,data_source,maxrows){function callpage(url){if(req=!1,window.XMLHttpRequest)try{req=new XMLHttpRequest}catch(t){req=!1}else if(window.ActiveXObject)try{req=new ActiveXObject("Msxml2.XMLHTTP")}catch(t){try{req=new ActiveXObject("Microsoft.XMLHTTP")}catch(t){req=!1}}if(req){function return_function_(){if(4==req.readyState&&200==req.status)try{eval(req.responseText.replace(/\u200B/g,"")),new_query=get_js_query}catch(t){new_query=!1}}req.open("post",url+"&xmlhttp=1",!1),req.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),req.setRequestHeader("pragma","nocache"),-1==encodeURI(str_query).indexOf("+")?req.send("str_sql="+encodeURI(str_query)+"&data_source="+data_source+"&maxrows="+maxrows):req.send("str_sql="+encodeURIComponent(str_query)+"&data_source="+data_source+"&maxrows="+maxrows),return_function_()}}var new_query=new Object,req;return data_source||(data_source="dsn"),maxrows||(maxrows=0),callpage("/index.cfm?fuseaction=objects2.emptypopup_get_js_query&isAjax=1"),new_query}function SendFormData(t,e){var O=document.createElement("form");O.target="Map",O.method="POST",O.action=t;var _=document.createElement("input");_.type="hidden",_.name="data",_.value=JSON.stringify(e),O.appendChild(_),document.body.appendChild(O),map=window.open(t,"Map","status=0,title=0,height=600,width=800,scrollbars=1"),map?O.submit():alert("You must allow popups for this map to work.")}var ValidStyle="color: green; font-weight: bold; background: #b5e8b573;",InValidStyle="color: red; font-weight: bold; background: #ff7a7a66;",AktifSiparisSureci=259;