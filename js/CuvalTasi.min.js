function SearchBarcode(e,t){if(13==t.keyCode){var O=e.value;O=ReplaceAll(O,"||","|");list_getat(O,1,"|");var _=list_getat(O,2,"|"),a=list_getat(O,3,"|"),r="SELECT TOP 1 STORE DELIVER_DEPT_ID,STORE_LOCATION LOCATION_ID,STOCK_ID,PBS_RELATION_ID AS WRK_ROW_ID,UNIT2 FROM "+dsn2+".STOCKS_ROW WHERE  LOT_NO='"+_+"' ORDER BY PROCESS_DATE DESC,UPD_ID DESC",T=wrk_query(r);if(T.recordcount>0){e.setAttribute("style",ValidStyle),document.getElementById("txtFromDeptLocation").setAttribute("style",ValidStyle);var n="SELECT D.DEPARTMENT_HEAD,SL.COMMENT,SL.DEPARTMENT_ID,SL.LOCATION_ID FROM STOCKS_LOCATION as SL ";n+=" INNER JOIN DEPARTMENT AS D ON D.DEPARTMENT_ID=SL.DEPARTMENT_ID  WHERE SL.DEPARTMENT_ID="+T.DELIVER_DEPT_ID[0]+" AND SL.LOCATION_ID="+T.LOCATION_ID[0];var D=wrk_query(n);$("#txtFromDeptLocation").val(D.DEPARTMENT_HEAD[0]+" "+D.COMMENT[0]),$("#txtFromDeptId").val(D.DEPARTMENT_ID[0]),$("#txtFromLocId").val(D.LOCATION_ID[0]),$("#FROM_STOCK_ID").val(T.STOCK_ID[0]),$("#FROM_WRK_ROW_ID").val(T.WRK_ROW_ID[0]),$("#FROM_AMOUNT").val(a),$("#TO_AMOUNT").val(a),$("#FROM_LOT_NO").val(_),$("#FROM_UNIT2").val(T.UNIT2),$("#TO_LOT_NO").val(_),$("#exitr").show(500),$("#txtDepoAdi").focus()}else e.setAttribute("style",InValidStyle)}}function searchDepo(e,t){if(13==t.keyCode){var O=$("#FROM_STOCK_ID").val(),_="SELECT D.DEPARTMENT_HEAD,SL.COMMENT,SL.LOCATION_ID,SL.DEPARTMENT_ID FROM "+dsn+".STOCKS_LOCATION AS SL INNER JOIN DEPARTMENT AS D ON D.DEPARTMENT_ID=SL.DEPARTMENT_ID WHERE 1=1 AND COMMENT ='"+e.value+"'",a=wrk_query(_);if(a.recordcount>0){var r="SELECT O.ORDER_ID,ORDER_NUMBER,ORDER_HEAD,ORR.WRK_ROW_ID,ORR.STOCK_ID,ORR.UNIT2 FROM "+dsn3+".ORDERS AS O";r+=" INNER JOIN "+dsn3+".ORDER_ROW AS ORR ON ORR.ORDER_ID=O.ORDER_ID ",r+=" WHERE O.ORDER_STAGE="+AktifSiparisSureci+" AND O.DELIVER_DEPT_ID="+a.DEPARTMENT_ID[0]+" AND O.LOCATION_ID="+a.LOCATION_ID[0]+"  AND ORR.STOCK_ID="+O;var T=wrk_query(r);T.recordcount>0||15==a.DEPARTMENT_ID[0]?(e.setAttribute("style",ValidStyle),document.getElementById("txtToDeptLocation").setAttribute("style",ValidStyle),$("#txtToDeptId").val(a.DEPARTMENT_ID[0]),$("#txtToLocId").val(a.LOCATION_ID[0]),$("#txtToDeptLocation").val(a.DEPARTMENT_HEAD[0]+"-"+a.COMMENT[0]),$("#TO_STOCK_ID").val(O),T.recordcount>0?$("#TO_WRK_ROW_ID").val(T.WRK_ROW_ID[0]):$("#TO_WRK_ROW_ID").val(""),$("#btnKayit").show()):(e.setAttribute("style",InValidStyle),document.getElementById("txtToDeptLocation").setAttribute("style",InValidStyle))}else e.setAttribute("style",InValidStyle)}}function searchDepo_2(e,t){var O=$("#FROM_STOCK_ID").val(),_="SELECT D.DEPARTMENT_HEAD,SL.COMMENT,SL.LOCATION_ID,SL.DEPARTMENT_ID FROM "+dsn+".STOCKS_LOCATION AS SL INNER JOIN DEPARTMENT AS D ON D.DEPARTMENT_ID=SL.DEPARTMENT_ID WHERE 1=1 AND COMMENT ='"+e.value+"'",a=wrk_query(_);if(a.recordcount>0){var r="SELECT O.ORDER_ID,ORDER_NUMBER,ORDER_HEAD,ORR.WRK_ROW_ID,ORR.STOCK_ID,ORR.UNIT2 FROM "+dsn3+".ORDERS AS O";r+=" INNER JOIN "+dsn3+".ORDER_ROW AS ORR ON ORR.ORDER_ID=O.ORDER_ID ",r+=" WHERE O.ORDER_STAGE="+AktifSiparisSureci+" AND O.DELIVER_DEPT_ID="+a.DEPARTMENT_ID[0]+" AND O.LOCATION_ID="+a.LOCATION_ID[0]+"  AND ORR.STOCK_ID="+O;var T=wrk_query(r);T.recordcount>0||15==a.DEPARTMENT_ID[0]?(e.setAttribute("style",ValidStyle),document.getElementById("txtToDeptLocation").setAttribute("style",ValidStyle),$("#txtToDeptId").val(a.DEPARTMENT_ID[0]),$("#txtToLocId").val(a.LOCATION_ID[0]),$("#txtToDeptLocation").val(a.DEPARTMENT_HEAD[0]+"-"+a.COMMENT[0]),$("#TO_STOCK_ID").val(O),T.recordcount>0?$("#TO_WRK_ROW_ID").val(T.WRK_ROW_ID[0]):$("#TO_WRK_ROW_ID").val(""),$("#btnKayit").show()):(e.setAttribute("style",InValidStyle),document.getElementById("txtToDeptLocation").setAttribute("style",InValidStyle))}else e.setAttribute("style",InValidStyle)}function Kaydet(){var e=$("#txtFromDeptId").val(),t=$("#txtFromLocId").val(),O=$("#FROM_WRK_ROW_ID").val(),_=$("#FROM_STOCK_ID").val(),a=$("#FROM_AMOUNT").val(),r=$("#FROM_LOT_NO").val(),T=$("#FROM_UNIT2").val(),n=$("#txtToDeptId").val(),D=$("#txtToLocId").val(),R=$("#TO_WRK_ROW_ID").val(),o=$("#TO_STOCK_ID").val(),l=$("#TO_AMOUNT").val(),E=$("#TO_LOT_NO").val(),I={FROM_DEPARTMENT_ID:e,FROM_LOCATION_ID:t,FROM_WRK_ROW_ID:O,FROM_STOCK_ID:_,FROM_AMOUNT:a,FROM_LOT_NO:r,TO_DEPARTMENT_ID:n,TO_LOCATION_ID:D,TO_WRK_ROW_ID:R,TO_STOCK_ID:o,TO_AMOUNT:l,TO_LOT_NO:E,FROM_UNIT2:T};console.log(I),SendFormData("/index.cfm?fuseaction=settings.emptypopup_partner_test_page&sayfa=14",I)}function sepeteEkle(e,t,O,_,a,r,T,n,D,R,o,l){console.table(arguments);var E=document.createElement("tr"),I=document.createElement("td");I.innerText=T,E.appendChild(I);I=document.createElement("td");I.innerText=t,E.appendChild(I);I=document.createElement("td");I.innerText=O+" "+_,E.appendChild(I);I=document.createElement("td");I.innerText=n+" "+D,E.appendChild(I);I=document.createElement("td");I.innerHTML=a+" &gt; "+r,E.appendChild(I);I=document.createElement("td");I.innerHTML=o+" &gt; "+l,E.appendChild(I);I=document.createElement("td");var d=document.createElement("button");d.setAttribute("class","btn btn-danger"),d.innerText="Sil",d.setAttribute("onclick","fis_sil("+R+",this)"),I.appendChild(d),E.appendChild(I),document.getElementById("Sepetim").appendChild(E)}function fis_sil(e,t){$.ajax({url:"/AddOns/Partner/Servis/MasaServis.cfc?method=deleteSelectedFis&FIS_ID="+e,success:function(e){console.log(e),t.parentElement.parentElement.remove()}})}function wrk_query(str_query,data_source,maxrows){function callpage(url){if(req=!1,window.XMLHttpRequest)try{req=new XMLHttpRequest}catch(e){req=!1}else if(window.ActiveXObject)try{req=new ActiveXObject("Msxml2.XMLHTTP")}catch(e){try{req=new ActiveXObject("Microsoft.XMLHTTP")}catch(e){req=!1}}if(req){function return_function_(){if(4==req.readyState&&200==req.status)try{eval(req.responseText.replace(/\u200B/g,"")),new_query=get_js_query}catch(e){new_query=!1}}req.open("post",url+"&xmlhttp=1",!1),req.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),req.setRequestHeader("pragma","nocache"),-1==encodeURI(str_query).indexOf("+")?req.send("str_sql="+encodeURI(str_query)+"&data_source="+data_source+"&maxrows="+maxrows):req.send("str_sql="+encodeURIComponent(str_query)+"&data_source="+data_source+"&maxrows="+maxrows),return_function_()}}var new_query=new Object,req;return data_source||(data_source="dsn"),maxrows||(maxrows=0),callpage("/index.cfm?fuseaction=objects2.emptypopup_get_js_query&isAjax=1"),new_query}function SendFormData(e,t){var O=document.createElement("form");O.target="Map",O.method="POST",O.action=e;var _=document.createElement("input");_.type="hidden",_.name="data",_.value=JSON.stringify(t),O.appendChild(_),document.body.appendChild(O),map=window.open(e,"Map","status=0,title=0,height=600,width=800,scrollbars=1"),map?O.submit():alert("You must allow popups for this map to work.")}var ValidStyle="color: green; font-weight: bold; background: #b5e8b573;",InValidStyle="color: red; font-weight: bold; background: #ff7a7a66;",AktifSiparisSureci=259;