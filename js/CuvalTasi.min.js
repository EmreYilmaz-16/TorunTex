function SearchBarcode(e,t){if(13==t.keyCode){var a=e.value;a=ReplaceAll(a,"||","|");list_getat(a,1,"|");var r=list_getat(a,2,"|"),n=list_getat(a,3,"|"),_="SELECT TOP 1 STORE DELIVER_DEPT_ID,STORE_LOCATION LOCATION_ID,STOCK_ID,PBS_RELATION_ID AS WRK_ROW_ID,UNIT2 FROM "+dsn2+".STOCKS_ROW WHERE  LOT_NO='"+r+"' ORDER BY PROCESS_DATE DESC,UPD_ID DESC",O=wrk_query(_);if(O.recordcount>0){e.setAttribute("style",ValidStyle),document.getElementById("txtFromDeptLocation").setAttribute("style",ValidStyle);var o="SELECT D.DEPARTMENT_HEAD,SL.COMMENT,SL.DEPARTMENT_ID,SL.LOCATION_ID FROM STOCKS_LOCATION as SL ";o+=" INNER JOIN DEPARTMENT AS D ON D.DEPARTMENT_ID=SL.DEPARTMENT_ID  WHERE SL.DEPARTMENT_ID="+O.DELIVER_DEPT_ID[0]+" AND SL.LOCATION_ID="+O.LOCATION_ID[0];var T=wrk_query(o);$("#txtFromDeptLocation").val(T.DEPARTMENT_HEAD[0]+" "+T.COMMENT[0]),$("#txtFromDeptId").val(T.DEPARTMENT_ID[0]),$("#txtFromLocId").val(T.LOCATION_ID[0]),$("#FROM_STOCK_ID").val(O.STOCK_ID[0]),$("#FROM_WRK_ROW_ID").val(O.WRK_ROW_ID[0]),$("#FROM_AMOUNT").val(n),$("#TO_AMOUNT").val(n),$("#FROM_LOT_NO").val(r),$("#FROM_UNIT2").val(O.UNIT2),$("#TO_LOT_NO").val(r),$("#exitr").show(500),$("#txtDepoAdi").focus()}else e.setAttribute("style",InValidStyle)}}function searchDepo(e,t){if(13==t.keyCode){var a=$("#FROM_STOCK_ID").val(),r="SELECT D.DEPARTMENT_HEAD,SL.COMMENT,SL.LOCATION_ID,SL.DEPARTMENT_ID FROM w3Toruntex.STOCKS_LOCATION AS SL INNER JOIN DEPARTMENT AS D ON D.DEPARTMENT_ID=SL.DEPARTMENT_ID WHERE 1=1 AND COMMENT ='"+e.value+"'",n=wrk_query(r);if(n.recordcount>0){var _="SELECT O.ORDER_ID,ORDER_NUMBER,ORDER_HEAD,ORR.WRK_ROW_ID,ORR.STOCK_ID,ORR.UNIT2 FROM "+dsn3+".ORDERS AS O";_+=" INNER JOIN "+dsn3+".ORDER_ROW AS ORR ON ORR.ORDER_ID=O.ORDER_ID ",_+=" WHERE O.ORDER_STAGE="+AktifSiparisSureci+" AND O.DELIVER_DEPT_ID="+n.DEPARTMENT_ID[0]+" AND O.LOCATION_ID="+n.LOCATION_ID[0]+"  AND ORR.STOCK_ID="+a;var O=wrk_query(_);O.recordcount>0||15==n.DEPARTMENT_ID[0]?(e.setAttribute("style",ValidStyle),document.getElementById("txtToDeptLocation").setAttribute("style",ValidStyle),$("#txtToDeptId").val(n.DEPARTMENT_ID[0]),$("#txtToLocId").val(n.LOCATION_ID[0]),$("#txtToDeptLocation").val(n.DEPARTMENT_HEAD[0]+"-"+n.COMMENT[0]),$("#TO_STOCK_ID").val(a),O.recordcount>0?$("#TO_WRK_ROW_ID").val(O.WRK_ROW_ID[0]):$("#TO_WRK_ROW_ID").val(""),$("#btnKayit").show()):(e.setAttribute("style",InValidStyle),document.getElementById("txtToDeptLocation").setAttribute("style",InValidStyle))}else e.setAttribute("style",InValidStyle)}}function Kaydet(){var e=$("#txtFromDeptId").val(),t=$("#txtFromLocId").val(),a=$("#FROM_WRK_ROW_ID").val(),r=$("#FROM_STOCK_ID").val(),n=$("#FROM_AMOUNT").val(),_=$("#FROM_LOT_NO").val(),O=$("#FROM_UNIT2").val(),o=$("#txtToDeptId").val(),T=$("#txtToLocId").val(),l=$("#TO_WRK_ROW_ID").val(),d=$("#TO_STOCK_ID").val(),D=$("#TO_AMOUNT").val(),c=$("#TO_LOT_NO").val(),R={FROM_DEPARTMENT_ID:e,FROM_LOCATION_ID:t,FROM_WRK_ROW_ID:a,FROM_STOCK_ID:r,FROM_AMOUNT:n,FROM_LOT_NO:_,TO_DEPARTMENT_ID:o,TO_LOCATION_ID:T,TO_WRK_ROW_ID:l,TO_STOCK_ID:d,TO_AMOUNT:D,TO_LOT_NO:c,FROM_UNIT2:O};console.log(R),SendFormData("/index.cfm?fuseaction=settings.emptypopup_partner_test_page&sayfa=14",R)}function sepeteEkle(e,t,a,r,n,_,O,o,T,l,d,D){console.table(arguments);var c=document.createElement("tr"),R=document.createElement("td");R.innerText=O,c.appendChild(R);R=document.createElement("td");R.innerText=t,c.appendChild(R);R=document.createElement("td");R.innerText=a+" "+r,c.appendChild(R);R=document.createElement("td");R.innerText=o+" "+T,c.appendChild(R);R=document.createElement("td");R.innerHTML=n+" &gt; "+_,c.appendChild(R);R=document.createElement("td");R.innerHTML=d+" &gt; "+D,c.appendChild(R);R=document.createElement("td");var i=document.createElement("button");i.setAttribute("class","btn btn-danger"),i.innerText="Sil",i.setAttribute("onclick","fis_sil("+l+",this)"),R.appendChild(i),c.appendChild(R),document.getElementById("Sepetim").appendChild(c)}function fis_sil(e,t){$.ajax({url:"/AddOns/Partner/Servis/MasaServis.cfc?method=deleteSelectedFis&FIS_ID="+e,success:function(e){console.log(e),t.parentElement.parentElement.remove()}})}function wrk_query(str_query,data_source,maxrows){function callpage(url){if(req=!1,window.XMLHttpRequest)try{req=new XMLHttpRequest}catch(e){req=!1}else if(window.ActiveXObject)try{req=new ActiveXObject("Msxml2.XMLHTTP")}catch(e){try{req=new ActiveXObject("Microsoft.XMLHTTP")}catch(e){req=!1}}if(req){function return_function_(){if(4==req.readyState&&200==req.status)try{eval(req.responseText.replace(/\u200B/g,"")),new_query=get_js_query}catch(e){new_query=!1}}req.open("post",url+"&xmlhttp=1",!1),req.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),req.setRequestHeader("pragma","nocache"),-1==encodeURI(str_query).indexOf("+")?req.send("str_sql="+encodeURI(str_query)+"&data_source="+data_source+"&maxrows="+maxrows):req.send("str_sql="+encodeURIComponent(str_query)+"&data_source="+data_source+"&maxrows="+maxrows),return_function_()}}var new_query=new Object,req;return data_source||(data_source="dsn"),maxrows||(maxrows=0),callpage("/index.cfm?fuseaction=objects2.emptypopup_get_js_query&isAjax=1"),new_query}function SendFormData(e,t){var a=document.createElement("form");a.target="Map",a.method="POST",a.action=e;var r=document.createElement("input");r.type="hidden",r.name="data",r.value=JSON.stringify(t),a.appendChild(r),document.body.appendChild(a),map=window.open(e,"Map","status=0,title=0,height=600,width=800,scrollbars=1"),map?a.submit():alert("You must allow popups for this map to work.")}var ValidStyle="color: green; font-weight: bold; background: #b5e8b573;",InValidStyle="color: red; font-weight: bold; background: #ff7a7a66;",AktifSiparisSureci=259;