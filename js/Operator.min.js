function OpenLogIn(){openBoxDraggable("index.cfm?fuseaction=settings.emptypopup_partner_test_page&sayfa=10","st00001")}function getOrders(e){var t=JSON.parse(localStorage.getItem("ACTIVE_STATION")),r=t.STATION;AjaxPageLoad("index.cfm?fuseaction=settings.emptypopup_partner_test_page&sayfa=16&STATION="+r+"&PRODUCT_ID="+e+"&ActiveSiparisId="+MainOrderRowID,"SiparisDataArea",1,"Yükleniyor")}function getAOrder(e,t=""){if(0==e.length&&0==MainOrderRowID){var r=JSON.parse(localStorage.getItem("ACTIVE_STATION"));return CurrentStation=r.STATION,getDepoUretim(r.STATION,r.GENERAL_STORE,r.GENERAL_LOCATION,"GET A ORDERDAN ÇALIŞTI"),!1}console.log("getAOrder Fonksiyonunu Çağıran="+t);var a=$("#ActiveSiparisId").val();console.log(" MainOrderRowID= "+MainOrderRowID+" ORDER_ROW_ID= "+e+"İnput Değeri 1="+a),$("#ActiveSiparisId").val(e),MainOrderRowID=e,$("#SiparisResultAreaAs").hide(500);a=$("#ActiveSiparisId").val();console.log(" MainOrderRowID= "+MainOrderRowID+" ORDER_ROW_ID= "+e+"İnput Değeri 2="+a),$.ajax({url:"/AddOns/Partner/servis/MasaServis.cfc?method=getAOrder&ORDER_ROW_ID="+e,success:function(e){try{var t=JSON.parse(e);if(-5!=t.ORDER_ROW_CURRENCY)alert("Üretim Durdurulmuştur"),TemizleCanim();else{$("#RenkYazi").text(t.PROPERTY5);var r=list_getat(t.PROPERTY5,1,"-"),a=list_getat(t.PROPERTY5,2,"-"),n="",o="";n="BEYAZ"==r?"white":"SARI"==r?"yellow":"YEŞİL"==r?"green":"antiquewhite",o="BEYAZ"==a?"white":"SARI"==a?"yellow":"YEŞİL"==a?"green":"MAVİ"==a?"blue":"antiquewhite",$("#color1").attr("style","display:block;border: solid 0.5px black;background: "+n+";width: 25%;"),$("#color2").attr("style","display:block;border: solid 0.5px black;background: "+o+";width: 25%;"),$("#SearchSiparisTxt").val(t.NICKNAME+" "+t.ORDER_NUMBER),$("#ActiveSiparisId").val(t.ORDER_ROW_ID),$("#Country").text(t.COUNTRY_NAME),$("#Customer").text(t.NICKNAME),$("#paketIcerik").val(t.A1),$("#paketKG").val(t.A2),$("#WRK_ROW_ID").val(t.WRK_ROW_ID),$("#SIP_DEPO").val(t.SIP_DEPO),$("#UNIT2").val(t.UNIT2),$("#OrderLocation").text(t.COMMENT),$("#AA1").text(t.DETAIL_INFO_EXTRA),$("#AA2").text(t.AA2),$("#AA3").text(t.AA3),$("#AA4").text(t.SA_PRODUCTION_NOTE),$("#sipres").html(""),$("#Complate").text(wrk_round(t.TAMAMLANMA)+" %");for(let e=0;e<t.ALL_ROWS.length;e++){var l=t.ALL_ROWS[e],O=document.createElement("tr"),i=document.createElement("td");i.innerText=l.PRODUCT_NAME,O.appendChild(i);i=document.createElement("td");i.innerText=commaSplit(l.QUANTITY),O.appendChild(i);i=document.createElement("td");i.innerText=commaSplit(l.R_AMOUNT),O.appendChild(i),document.getElementById("sipres").appendChild(O)}}}catch{TemizleCanim()}}})}function getProductionCount(){if(null!=localStorage.getItem("ACTIVE_STATION")){var e=JSON.parse(localStorage.getItem("ACTIVE_STATION")),t="SELECT COUNT(*) as FF FROM STOCK_FIS AS SF where DEPARTMENT_IN="+e.DEPARTMENT_ID+" AND LOCATION_IN="+e.LOCATION_ID+" AND DAY(FIS_DATE)=DAY(GETDATE()) AND MONTH(FIS_DATE)=MONTH(FIS_DATE)",r=wrk_query(t,"dsn2");$("#uretimCount").text(r.FF[0])}}function TemizleCanim(){$("#RenkYazi").text(""),$("#color1").attr("style","display:block;border: solid 0.5px black;background:none ;width: 25%;"),$("#color2").attr("style","display:block;border: solid 0.5px black;background:none;width: 25%;"),$("#Country").text(""),$("#OrderLocation").text(""),$("#Customer").text(""),$("#paketIcerik").val(""),$("#paketKG").val(""),$("#WRK_ROW_ID").val(""),$("#SIP_DEPO").val(""),$("#sipres").html(""),$("#Complate").text(""),$("#LotNo").val(""),$("#AA1").text(""),$("#AA2").text(""),$("#AA3").text(""),$("#AA4").text("")}function Yaz(e){if(TxResult.value.length>=3&&e>=0)return!1;e>0?"0"==TxResult.value&&-4!=e?TxResult.value=e:TxResult.value+=e:e<0?(-1==e&&(TxResult.value=TxResult.value.substr(0,TxResult.value.length-1)),-2==e&&(TxResult.value="0"),-3==e&&(TxResult.value=""),-4==e&&(TxResult.value+=","),-5==e&&(TxResult.value+="",$("#paketKG").val(TxResult.value))):"0"==e&&(TxResult.value+=e)}function GetDuyurus(e,t){}function SonrakiSayfa(){AktifSayfa++}function setSelAll(e){e.select()}function Yazdir(){var e=document.getElementById("paketKG").value,t=(document.getElementById("TxResult").value,document.getElementById("SIP_DEPO").value),r=JSON.parse(localStorage.ACTIVE_STATION),a=LotVer(r.STATION),n=document.getElementById("WRK_ROW_ID").value,o=document.getElementById("PRODUCT_ID").value,l=JSON.parse(localStorage.getItem("ACTIVE_STATION")),O=l.STATION,i=l.DEPARTMENT_ID+"-"+l.LOCATION_ID,T=l.DEPARTMENT_ID,I=l.LOCATION_ID;if(0==e.length)return alert("Onaylayınız"),!1;$.ajax({url:"/AddOns/Partner/Servis/MasaServis.cfc?method=SaveBelge&AMOUNT="+e+"&WRK_ROW_ID="+n+"&LOT_NUMARASI="+a+"&DEPO="+i+"&SIP_DEPO="+t+"&PRODUCT_ID="+o+"&ISTASYON="+O+"&UNIT2="+O,success:function(e){var a=JSON.parse(e);if(a.STATUS_CODE>=2)return alert(a.MESSAGE),!1;if(getOtherOrdersInfo(ActiveStockId),getProductionInfo(T,I),getProductionCount(),getProducts(O),console.log("YAZDIR--"+MainOrderRowID),0==MainOrderRowID){var n=list_getat(t,1,"-"),o=list_getat(t,2,"-");getDepoUretim(r.STATION,n,o,"YAZDIRDAN ÇALIŞTI")}else getAOrder(MainOrderRowID,"YAZDIRDAN GELDİM");var l=wrk_query("SELECT * FROM STATION_PRINTER_RELATION_PBS WHERE STORE_ID="+T+" AND LOCATION_ID="+I);if(0==l.recordcount)alert("Bu İstasyon İçin Yazıcı Tanımlanmamıştır Belge Kayıt Edildi Ancak Etiket Üretilmeyecektir !");else{var i=l.IP_ADDRESS[0];YazdirabilirsenYazdir(a.COMMENT,a.ORDER_NUMBER,a.PRODUCT_CODE_2,a.PRODUCT_DETAIL,a.LOT_NO,a.AMOUNT,a.PRODUCT_NAME,i)}}})}function Iptal(){var e="",t=document.getElementsByName("SELRADIO");for(let a=0;a<t.length;a++){var r=t[a];$(r).is(":checked")&&(e=r.value)}$.ajax({url:"/AddOns/Partner/Servis/MasaServis.cfc?method=deleteSelected&lot_no="+e,success:function(e){var t=JSON.parse(localStorage.getItem("ACTIVE_STATION")),r=(t.DEPARTMENT_ID,t.LOCATION_ID,t.DEPARTMENT_ID),a=t.LOCATION_ID;getOtherOrdersInfo(ActiveStockId),getProductionInfo(r,a),getProductionCount()}})}function YazdirabilirsenYazdir(e,t,r,a,n,o,l,O){var i=O,T=r+"|"+n+"||"+o,I="^XA^XFE:etiket2.ZPL^FS^CI28^FN1^FH^FD"+e+"^FS^CI27^CI28^FN2^FH^FD"+t+"^FS^CI27^CI28^FN3^FH^FD"+r+"^FS^CI27^CI28^FN4^FH^FD"+a+"^FS^CI27^CI28^FN5^FH^FD"+n+"^FS^CI27^CI28^FN6^FH^FD"+o+"^FS^CI27^CI28^FN7^FH^FD"+T+"^FS^CI27^CI28^FN8^FH^FD"+l+"^FS^CI27^PQ1,0,1^XZ",s="http://"+i+"/pstprnt",u="POST",_=!0,R=new XMLHttpRequest;R.onload=function(){var e=R.status,t=R.responseText;output.innerHTML="Status: "+e+"<br>"+t},R.open(u,s,_),R.setRequestHeader("Content-Length",I.length),R.send(I)}function setStation(e,t,r,a){var n=wrk_query("SELECT DEPARTMENT_ID,LOCATION_ID FROM STOCKS_LOCATION WHERE COMMENT='"+r+"'","dsn");console.log(n);var o={DEPARTMENT_ID:e,LOCATION_ID:t,STATION:r,FULL_STATION:a,GENERAL_STORE:n.DEPARTMENT_ID[0],GENERAL_LOCATION:n.LOCATION_ID[0]};localStorage.setItem("ACTIVE_STATION",JSON.stringify(o)),$("#butonAre").html("");var l=document.createElement("button");l.setAttribute("class","btn btn-lg btn-outline-danger"),l.innerText="Çıkış Yap",l.setAttribute("onclick","LogOut()"),document.getElementById("butonAre").appendChild(l),$("#Location").text(a),CurrentStation=o.STATION,getProducts(r),getProductionInfo(e,t),closeBoxDraggable("st00001")}function getProductionInfo(e,t){AjaxPageLoad("index.cfm?fuseaction=settings.emptypopup_partner_test_page&sayfa=11&DEPARTMENT_ID="+e+"&LOCATION_ID="+t,"ProductionData",1,"Yükleniyor")}function LogOut(){localStorage.removeItem("ACTIVE_STATION"),localStorage.removeItem("ACTIVE_USER"),window.location.reload()}function getOtherOrdersInfo(e){AjaxPageLoad("index.cfm?fuseaction=settings.emptypopup_partner_test_page&sayfa=12&STOCK_ID="+e,"DigerSiparis",1,"Yükleniyor")}function getProducts(e){var t="SELECT DISTINCT * FROM (";t+=" SELECT PRODUCT_NAME,STOCKS.PRODUCT_ID,STOCK_ID,PRODUCT_DETAIL FROM w3Toruntex_1.STOCKS LEFT JOIN w3Toruntex_1.PRODUCT_INFO_PLUS ON PRODUCT_INFO_PLUS.PRODUCT_ID=STOCKS.PRODUCT_ID ",t+=" WHERE PRODUCT_CATID NOT IN (26) AND PROPERTY1 LIKE '%"+e+"%'  UNION ALL   SELECT S.PRODUCT_NAME,S.PRODUCT_ID,S.STOCK_ID,S.PRODUCT_DETAIL FROM w3Toruntex_1.ORDER_ROW ",t+=" INNER JOIN w3Toruntex_1.STOCKS AS S ON S.STOCK_ID =ORDER_ROW.STOCK_ID  WHERE UNIT2 LIKE '%"+e+"%' AND ORDER_ROW_CURRENCY IN (-5) )  AS T";var r=wrk_query(t,"dsn3"),a=$sipSelect[0].selectize;a.clearOptions();for(let e=0;e<r.PRODUCT_NAME.length;e++)a.addOption({PRODUCT_NAME:r.PRODUCT_NAME[e],PRODUCT_ID:r.PRODUCT_ID[e],STOCK_ID:r.STOCK_ID[e],PRODUCT_DETAIL:r.PRODUCT_DETAIL[e]});ActiveStockId.length>0&&a.setValue(ActiveStockId),getProductionCount()}function YenidenFisYazdir(){var e="",t=document.getElementsByName("SELRADIO");for(let a=0;a<t.length;a++){var r=t[a];$(r).is(":checked")&&(e=r.value)}var a=e,n="SELECT TOP 1 SR.STOCK_ID,UPD_ID,SF.DEPARTMENT_IN,SF.LOCATION_IN,SR.PBS_RELATION_ID,O.ORDER_NUMBER,SL.COMMENT,S.PRODUCT_CODE,S.PRODUCT_CODE_2,S.MANUFACT_CODE,S.PRODUCT_NAME,SR.LOT_NO,SR.STOCK_IN AS AMOUNT,S.PRODUCT_DETAIL  FROM STOCKS_ROW AS SR INNER JOIN STOCK_FIS AS SF ON SF.FIS_ID=SR.UPD_ID";n+=" LEFT JOIN w3Toruntex_1.ORDER_ROW AS ORR ON ORR.WRK_ROW_ID=SR.PBS_RELATION_ID LEFT JOIN w3Toruntex_1.ORDERS AS O ON O.ORDER_ID=ORR.ORDER_ID",n+=" INNER JOIN w3Toruntex.STOCKS_LOCATION AS SL ON SL.DEPARTMENT_ID=SF.DEPARTMENT_IN AND SL.LOCATION_ID=SF.LOCATION_IN",n+=" INNER JOIN w3Toruntex_1.STOCKS AS S ON S.STOCK_ID=SR.STOCK_ID",n+=" WHERE SR.LOT_NO='"+a+"' ORDER BY UPD_ID DESC";var o=wrk_query(n,"DSN2"),l=JSON.parse(localStorage.getItem("ACTIVE_STATION")),O=wrk_query("SELECT * FROM STATION_PRINTER_RELATION_PBS WHERE STORE_ID="+l.DEPARTMENT_ID+" AND LOCATION_ID="+l.LOCATION_ID);if(0==O.recordcount)alert("Bu İstasyon İçin Yazıcı Tanımlanmamıştır Belge Kayıt Edildi Ancak Etiket Üretilmeyecektir !");else{var i=O.IP_ADDRESS[0];YazdirabilirsenYazdir(o.COMMENT[0],o.ORDER_NUMBER[0],o.PRODUCT_CODE_2[0],o.PRODUCT_DETAIL[0],o.LOT_NO[0],o.AMOUNT[0],o.PRODUCT_NAME[0],i)}}function LotVer(STATION){var d=new Date,Sdate=d.toLocaleString(),Sda=list_getat(Sdate,1," "),ReturnValue="",Qstr=wrk_query("SELECT * FROM  PBS_LOT_NUMBER","dsn3"),Lot=Qstr.LOT_NO[0],SifirSay="";1==Lot.length?SifirSay="00000":2==Lot.length?SifirSay="0000":3==Lot.length?SifirSay="000":4==Lot.length?SifirSay="00":5==Lot.length&&(SifirSay="0");var KLB="1",SCK="2",GRB="3";ReturnValue+=eval(STATION);var tsss=Math.floor(1100*Math.random())+1e3;return ReturnValue+=tsss.toString(),ReturnValue+=SifirSay,ReturnValue+=Lot,$.post("/AddOns/Partner/Servis/MasaServis.cfc?method=UpLot"),ReturnValue}function getDepoUretim(e,t,r,a){MainOrderRowID=0,console.log(arguments),console.log("GetDepoÜretim Çalıştı"),$("#SiparisResultAreaAs").hide(500),$("#RenkYazi").text(""),$("#color1").attr("style","display:block;border: solid 0.5px black;background:none ;width: 25%;"),$("#color2").attr("style","display:block;border: solid 0.5px black;background:none;width: 25%;"),$("#Country").text(""),$("#OrderLocation").text(e),$("#Customer").text(""),$("#paketIcerik").val("");var n=wrk_query("SELECT PROPERTY1,PROPERTY2,PROPERTY3 FROM PRODUCT_INFO_PLUS WHERE PRODUCT_ID="+ActiveStockId,"DSN3");0==n.recordcount?$("#paketKG").val(""):$("#paketKG").val(n.PROPERTY3[0]),console.table(n),$("#WRK_ROW_ID").val(""),$("#SIP_DEPO").val(t+"-"+r),$("#sipres").html(""),$("#Complate").text(""),$("#ActiveSiparisId").val(""),$("#SearchSiparisTxt").val(e)}function wrk_query(str_query,data_source,maxrows){function callpage(url){if(req=!1,window.XMLHttpRequest)try{req=new XMLHttpRequest}catch(e){req=!1}else if(window.ActiveXObject)try{req=new ActiveXObject("Msxml2.XMLHTTP")}catch(e){try{req=new ActiveXObject("Microsoft.XMLHTTP")}catch(e){req=!1}}if(req){function return_function_(){if(4==req.readyState&&200==req.status)try{eval(req.responseText.replace(/\u200B/g,"")),new_query=get_js_query}catch(e){new_query=!1}}req.open("post",url+"&xmlhttp=1",!1),req.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),req.setRequestHeader("pragma","nocache"),-1==encodeURI(str_query).indexOf("+")?req.send("str_sql="+encodeURI(str_query)+"&data_source="+data_source+"&maxrows="+maxrows):req.send("str_sql="+encodeURIComponent(str_query)+"&data_source="+data_source+"&maxrows="+maxrows),return_function_()}}var new_query=new Object,req;return data_source||(data_source="dsn"),maxrows||(maxrows=0),callpage("/index.cfm?fuseaction=objects2.emptypopup_get_js_query&isAjax=1"),new_query}var $select=null,$sipSelect=null,MainOrderRowID=0,CurrentStation=null,ActiveStockId=0,ActiveOrderRowID=0;$(document).ready(function(){document.getElementById("wrk_main_layout").setAttribute("class","container-fluid"),$sipSelect=$("#select_1").selectize({valueField:"PRODUCT_ID",labelField:"PRODUCT_NAME",searchField:"PRODUCT_NAME",onChange:eventHandler_1("onChange")}),$select=$("#select_2").selectize({valueField:"ORDER_ROW_ID",labelField:"ORDER_NUMBER",searchField:"ORDER_NUMBER",onChange:eventHandler_2("onChange")}),document.body.setAttribute("style","overflow-y: hidden;");var e=document.createElement("button");if(null!=localStorage.getItem("ACTIVE_STATION")){var t=JSON.parse(localStorage.getItem("ACTIVE_STATION"));CurrentStation=t.STATION,$("#Location").text(t.FULL_STATION),getProducts(CurrentStation),getProductionInfo(t.DEPARTMENT_ID,t.LOCATION_ID),e.setAttribute("class","btn btn-lg btn-outline-danger"),e.innerText="Çıkış Yap",e.setAttribute("onclick","LogOut()")}else e.setAttribute("class","btn btn-lg btn-outline-primary"),e.innerText="Kullanıcı Girişi",e.setAttribute("onclick","OpenLogIn()"),OpenLogIn();document.getElementById("butonAre").appendChild(e),$("#wrk_bug_add_div").hide(),GetDuyurus()});var eventHandler_1=function(e){return function(){console.log("event handler 1 çalıştı !!!!"),$("#PRODUCT_ID").val(arguments[0]),ActiveStockId=arguments[0],getOtherOrdersInfo(arguments[0]),getOrders(arguments[0])}},eventHandler_2=function(e){return function(){getAOrder(arguments[0],"event handler 2den geldim")}},str="",AktifSayfa=1;